<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Black Hole Visualization</title>

    <link rel="stylesheet" href="./src/css/loading.css">
    <link rel="stylesheet" href="./src/css/main.css">
    <link rel="stylesheet" href="./src/css/start.css">

    <link rel="stylesheet" href="./src/css/radialMenu.css">
    <link rel="stylesheet" href="./src/css/aboutme.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>



</head>

<body>
    <div id="loading-screen">
        <div id="blackhole">
            <div class="blackhole-centerHover">
                <span>Welcome to my website</span>

            </div>
        </div>
    </div>
    <div id="main-content">
        <div class="space-container">
            <canvas id="space"></canvas>
        </div>
        <div id="about-me-section-wrapper">
            <!-- 粒子动画的HTML结构 -->
            <div class="particle-bg-wrapper">
                <div class="particle-creature"></div>
            </div>

            <!-- SVG文本动画的HTML结构 -->
            <div class="svg-text-container">
                <svg viewBox="0 0 1280 720" preserveAspectRatio="xMidYMid meet">
                    <!-- 将分割线左移，原为-50%/50% -->
                    <mask id="maskLeft_component">
                        <rect x="-65%" width="100%" height="100%" fill="#fff" />
                    </mask>
                    <mask id="maskRight_component">
                        <rect x="35%" width="100%" height="100%" fill="#fff" />
                    </mask>
                    <!-- 移除了固定的font-size，现在由CSS控制 -->
                    <g font-weight="800">
                        <g mask="url(#maskLeft_component)" fill="#fff" class="left-text">
                            <text text-anchor="middle" y="220" class="about-me-text">ABOUT ME</text>
                            <text text-anchor="middle" y="300">Veteran ACG Enthusiast</text>
                            <text text-anchor="middle" y="380">Senior CV Engineer</text>
                            <text text-anchor="middle" y="460">Visual Supremacy</text>
                        </g>
                        <g mask="url(#maskRight_component)" fill="#aaa" class="right-text">
                            <text text-anchor="middle" y="220" class="about-me-text">ABOUT ME</text>
                            <text text-anchor="middle" y="300">Veteran ACG Enthusiast</text>
                            <text text-anchor="middle" y="380">Senior CV Engineer</text>
                            <text text-anchor="middle" y="460">Visual Supremacy</text>
                        </g>
                    </g>
                </svg>
            </div>
        </div>
        <div id="creature-wrapper">
            <div class="content-container">
                <div class="radial-menu" id="radialMenu">
                    <button id="fabRadial" aria-label="切换菜单">
                        <i>=</i>
                    </button>

                    <div class="menu-item">
                        主页
                    </div>
                    <div class="menu-item">
                        作品
                    </div>
                    <div class="menu-item">
                        关于
                    </div>
                    <div class="menu-item">
                        联系
                    </div>
                </div>

            </div>

            <!-- <div>内容2222222222222222222222222222</div> -->
        </div>
    </div>





    <script src="./src/js/loading.js"></script>
    <script src="./src/js/start.js"></script>
    <script src="./src/js/radialMenu.js"></script>
    <script type="module">
  
        import { animate, createTimeline, createTimer, stagger, utils } from 'https://esm.sh/animejs';

        /**
         * 初始化封装的“关于我”动画板块
         * @param {string} containerSelector - 主容器的CSS选择器
         */
        function initAboutMeAnimation(containerSelector) {
            const container = document.querySelector(containerSelector);
            if (!container) {
                console.error("Animation container not found:", containerSelector);
                return;
            }

            // --- 1. 粒子背景动画 (anime.js) ---
            const creatureEl = container.querySelector('.particle-creature');
            const viewport = { w: container.clientWidth, h: container.clientHeight };
            const cursor = { x: 0, y: 0 };
            const rows = 12;
            const grid = [rows, rows];
            const from = 'center';

            if (creatureEl.children.length === 0) {
                for (let i = 0; i < (rows * rows); i++) {
                    creatureEl.appendChild(document.createElement('div'));
                }
            }

            const particuleEls = creatureEl.querySelectorAll('div');
            const scaleStagger = stagger([2, 5], { ease: 'inQuad', grid, from });
            const opacityStagger = stagger([1, .1], { grid, from });

            utils.set(creatureEl, { width: rows * 10 + 'em', height: rows * 10 + 'em' });
            utils.set(particuleEls, {
                x: 0, y: 0, scale: scaleStagger, opacity: opacityStagger,
                background: stagger([80, 20], { grid, from, modifier: v => `hsl(4, 70%, ${v}%)` }),
                boxShadow: stagger([8, 1], { grid, from, modifier: v => `0px 0px ${utils.round(v, 0)}em 0px var(--red)` }),
                zIndex: stagger([rows * rows, 1], { grid, from, modifier: utils.round(0) }),
            });

            const pulse = () => {
                animate(particuleEls, {
                    keyframes: [
                        { scale: 5, opacity: 1, delay: stagger(90, { start: 1650, grid, from }), duration: 150 },
                        { scale: scaleStagger, opacity: opacityStagger, ease: 'inOutQuad', duration: 600 }
                    ],
                });
            }

            const mainLoop = createTimer({
                frameRate: 15,
                onUpdate: () => {
                    animate(particuleEls, {
                        x: cursor.x, y: cursor.y,
                        delay: stagger(40, { grid, from }),
                        duration: stagger(120, { start: 750, ease: 'inQuad', grid, from }),
                        ease: 'inOut', composition: 'blend',
                    });
                }
            });

            const autoMove = createTimeline()
                .add({ targets: cursor, x: [-viewport.w * .25, viewport.w * .25], modifier: x => x + Math.sin(mainLoop.currentTime * .0007) * viewport.w * .2, duration: 3000, ease: 'inOutExpo', alternate: true, loop: true, onBegin: pulse, onLoop: pulse }, 0)
                .add({ targets: cursor, y: [-viewport.h * .25, viewport.h * .25], modifier: y => y + Math.cos(mainLoop.currentTime * .00012) * viewport.h * .2, duration: 1000, ease: 'inOutQuad', alternate: true, loop: true }, 0);

            const manualMovementTimeout = createTimer({ duration: 1500, onComplete: () => autoMove.play() });

            const followPointer = e => {
                const event = e.type === 'touchmove' ? e.touches[0] : e;
                const rect = container.getBoundingClientRect();
                cursor.x = (event.clientX - rect.left) - (viewport.w * 0.5);
                cursor.y = (event.clientY - rect.top) - (viewport.h * 0.5);
                autoMove.pause();
                manualMovementTimeout.restart();
            }

            // --- 2. SVG文本动画 (GSAP) ---
            const tl = gsap.timeline({
                defaults: { duration: 2, yoyo: true, repeat: -1, ease: 'power2.inOut' }
            })
                .fromTo(container.querySelectorAll('.left-text, .right-text'), {
                    svgOrigin: '448 360', // 调整动画原点以匹配新的分割线 (1280 * 0.35)
                    skewY: (i) => [-30, 15][i],
                    scaleX: (i) => [0.6, 0.85][i],
                    x: 200
                }, {
                    skewY: (i) => [-15, 30][i],
                    scaleX: (i) => [0.85, 0.6][i],
                    x: -200
                })
                .play(.5);

            const tl2 = gsap.timeline({ repeat: -1, yoyo: true });
            container.querySelectorAll('text').forEach((t, i) => {
                tl2.add(gsap.fromTo(t, {
                    xPercent: -100, x: 700
                }, {
                    duration: 1, xPercent: 0, x: 640, ease: 'sine.inOut'
                }), i % 4 * 0.2);
            });

            // --- 3. 事件监听 ---
            // 只在当前容器内监听鼠标移动
            container.onpointermove = (e) => {
                followPointer(e);
                tl.pause();
                tl2.pause();
                const rect = container.getBoundingClientRect();
                const progress = (e.clientX - rect.left) / rect.width;
                gsap.to([tl, tl2], {
                    duration: 2,
                    ease: 'power4',
                    progress: progress
                });
            };

            // 窗口缩放时更新视口尺寸
            window.addEventListener('resize', () => {
                viewport.w = container.clientWidth;
                viewport.h = container.clientHeight;
            });
        }

        // DOM加载完毕后，初始化动画
        document.addEventListener('DOMContentLoaded', () => {
            initAboutMeAnimation('#about-me-section-wrapper');
        });
    </script>



</body>

</html>